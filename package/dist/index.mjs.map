{"version":3,"sources":["../src/normalizePage.ts","../src/withPage.ts"],"sourcesContent":["import { NodeEntry, Transforms, Element, Node } from \"slate\"\r\nimport { ReactEditor } from \"slate-react\"\r\nimport { opsType } from \"./types/custom-types\"\r\n\r\nexport default function normalizePage(entry: NodeEntry, editor: ReactEditor, ops: opsType){\r\n    const [node, path] = entry\r\n\r\n    if (Element.isElement(node) && node.type === ops.pageTypeName) {\r\n      let PageNode: HTMLElement\r\n      let NextPageNode: ChildNode | null\r\n      let PageHeight: number\r\n      let ChildrenHeight = 0\r\n      try{\r\n        PageNode = ReactEditor.toDOMNode(editor, node)\r\n        NextPageNode = PageNode.nextSibling\r\n        const styles = window.getComputedStyle(PageNode)\r\n        PageHeight = PageNode.clientHeight - (parseFloat(styles.paddingTop) + parseFloat(styles.paddingBottom))\r\n      }catch(e){\r\n        return\r\n      }\r\n  \r\n      let innerContainer = (PageNode.children[0] as HTMLElement)\r\n  \r\n      for (const child of innerContainer.children){\r\n        ChildrenHeight += child.clientHeight\r\n      }\r\n  \r\n      const delta = PageHeight - ChildrenHeight\r\n      \r\n      if (delta < 0  && NextPageNode == null){\r\n        Transforms.liftNodes(editor)\r\n        Transforms.splitNodes(editor)\r\n        Transforms.wrapNodes(editor, ops.emptyPage)\r\n      } else if (delta < 0 && NextPageNode != null){\r\n        try {\r\n          Transforms.moveNodes(editor, {to: [path[0] + 1, 0]})\r\n        } catch (e){\r\n          return \r\n        }\r\n      }\r\n    }\r\n  }","import { ReactEditor } from 'slate-react'\r\nimport normalizePage from './normalizePage';\r\n\r\n\r\nconst withPages = (editor: ReactEditor, ops: any) => {\r\n  const { normalizeNode } = editor\r\n\r\n  editor.normalizeNode = (entry) => {\r\n      setTimeout(() => {\r\n        normalizePage(entry, editor, ops)\r\n      }, 10)\r\n      normalizeNode(entry)\r\n    }\r\n  return editor\r\n}\r\n\r\nexport default withPages"],"mappings":";AAAA,SAAoB,YAAY,eAAqB;AACrD,SAAS,mBAAmB;AAGb,SAAR,cAA+B,OAAkB,QAAqB,KAAa;AACtF,QAAM,CAAC,MAAM,IAAI,IAAI;AAErB,MAAI,QAAQ,UAAU,IAAI,KAAK,KAAK,SAAS,IAAI,cAAc;AAC7D,QAAI;AACJ,QAAI;AACJ,QAAI;AACJ,QAAI,iBAAiB;AACrB,QAAG;AACD,iBAAW,YAAY,UAAU,QAAQ,IAAI;AAC7C,qBAAe,SAAS;AACxB,YAAM,SAAS,OAAO,iBAAiB,QAAQ;AAC/C,mBAAa,SAAS,gBAAgB,WAAW,OAAO,UAAU,IAAI,WAAW,OAAO,aAAa;AAAA,IACvG,SAAO,GAAE;AACP;AAAA,IACF;AAEA,QAAI,iBAAkB,SAAS,SAAS,CAAC;AAEzC,eAAW,SAAS,eAAe,UAAS;AAC1C,wBAAkB,MAAM;AAAA,IAC1B;AAEA,UAAM,QAAQ,aAAa;AAE3B,QAAI,QAAQ,KAAM,gBAAgB,MAAK;AACrC,iBAAW,UAAU,MAAM;AAC3B,iBAAW,WAAW,MAAM;AAC5B,iBAAW,UAAU,QAAQ,IAAI,SAAS;AAAA,IAC5C,WAAW,QAAQ,KAAK,gBAAgB,MAAK;AAC3C,UAAI;AACF,mBAAW,UAAU,QAAQ,EAAC,IAAI,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,EAAC,CAAC;AAAA,MACrD,SAAS,GAAE;AACT;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACF;;;ACrCF,IAAM,YAAY,CAAC,QAAqB,QAAa;AACnD,QAAM,EAAE,cAAc,IAAI;AAE1B,SAAO,gBAAgB,CAAC,UAAU;AAC9B,eAAW,MAAM;AACf,oBAAc,OAAO,QAAQ,GAAG;AAAA,IAClC,GAAG,EAAE;AACL,kBAAc,KAAK;AAAA,EACrB;AACF,SAAO;AACT;AAEA,IAAO,mBAAQ;","names":[]}